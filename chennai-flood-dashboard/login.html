<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Authority Login | Chennai Flood Watch</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Inter', sans-serif; }
    .login-bg {
      background: linear-gradient(rgba(29,78,216,.9), rgba(29,78,216,.9)),
        url("https://images.unsplash.com/photo-1622384381387-a859424854f6?q=80&w=1932&auto=format&fit=crop");
      background-size: cover;
      background-position: center;
    }
  </style>
</head>

<body class="bg-gray-50">

<div class="min-h-screen flex">

  <!-- Left panel -->
  <div class="hidden lg:flex w-1/2 login-bg items-center justify-center p-12 text-white">
    <div class="text-center">
      <h1 class="text-4xl font-bold mb-3">Chennai Flood Watch</h1>
      <p class="text-lg text-blue-100">
        Official Portal for Disaster Management Authorities
      </p>
    </div>
  </div>

  <!-- Right panel -->
  <div class="w-full lg:w-1/2 flex items-center justify-center p-8">
    <div class="max-w-md w-full">

      <h2 class="text-3xl font-bold text-center mb-2">
        Authority Login
      </h2>

      <p class="text-center text-gray-600 mb-6">
        Sign in to access the flood monitoring dashboard.
      </p>

      <div
        id="clerk-signin-container"
        class="min-h-[380px] flex items-center justify-center"
      >
        <p class="text-gray-400">Loading secure loginâ€¦</p>
      </div>

      <p class="text-center text-sm text-gray-500 mt-4">
        New authority? You can sign up from the login panel.
      </p>

    </div>
  </div>

</div>

<!-- ðŸ”’ CLERK SCRIPT -->
<script
  async
  crossorigin="anonymous"
  data-clerk-publishable-key="pk_test_ZGFyaW5nLWxvYnN0ZXItMTIuY2xlcmsuYWNjb3VudHMuZGV2JA"
  src="https://daring-lobster-12.clerk.accounts.dev/npm/@clerk/clerk-js@5/dist/clerk.browser.js"
  type="text/javascript">
</script>
<script>
  window.addEventListener("load", async () => {
    try {
      await Clerk.load();

      // âœ… Correct way to check sign-in in Clerk v5
      if (Clerk.session) {
        window.location.href = "/chennai-flood-dashboard/index.html";
        return;
      }

      // âœ… Mount Sign In
      Clerk.mountSignIn(
        document.getElementById("clerk-signin-container"),
        {
          appearance: {
            variables: { colorPrimary: "#2563eb" }
          },
          afterSignInUrl: "/chennai-flood-dashboard/index.html",
          afterSignUpUrl: "/chennai-flood-dashboard/index.html"
        }
      );

    } catch (err) {
      console.error("Clerk failed:", err);
      document.getElementById("clerk-signin-container").innerHTML =
        "<p class='text-red-500'>Authentication service unavailable. Please refresh.</p>";
    }
  });
</script>
